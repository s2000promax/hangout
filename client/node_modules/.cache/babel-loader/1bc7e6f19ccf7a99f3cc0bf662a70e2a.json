{"ast":null,"code":"var _jsxFileName = \"/home/designer/GitHub/hangout/client/src/app/components/page/usersListPage/usersListPage.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { paginate } from \"../../../utils/paginate\";\nimport Pagination from \"../../common/pagination\";\nimport GroupList from \"../../common/groupList\";\nimport SearchStatus from \"../../ui/searchStatus\";\nimport UserTable from \"../../ui/usersTable\";\nimport _ from \"lodash\";\nimport { getProfessions, getProfessionsLoadingStatus } from \"../../../store/professions\";\nimport { useSelector } from \"react-redux\";\nimport { getCurrentUserId, getUsersList } from \"../../../store/users\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UsersListPage = () => {\n  _s();\n\n  const users = useSelector(getUsersList());\n  const currentUserId = useSelector(getCurrentUserId());\n  const professions = useSelector(getProfessions());\n  const professionsLoading = useSelector(getProfessionsLoadingStatus());\n  const [currentPage, setCurrentPage] = useState(1);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedProf, setSelectedProf] = useState();\n  const [sortBy, setSortBy] = useState({\n    path: \"name\",\n    order: \"asc\"\n  });\n  const pageSize = 8;\n\n  const handleDelete = userId => {\n    console.log(\"delete user\"); // setUsers(users.filter((user) => user._id !== userId));\n  };\n\n  const handleToggleBookMark = id => {\n    const newArray = users.map(user => {\n      if (user._id === id) {\n        return { ...user,\n          bookmark: !user.bookmark\n        };\n      }\n\n      return user;\n    }); // setUsers(newArray);\n\n    console.log(newArray);\n  };\n\n  useEffect(() => {\n    setCurrentPage(1);\n  }, [selectedProf, searchQuery]);\n\n  const handleProfessionSelect = item => {\n    if (searchQuery !== \"\") setSearchQuery(\"\");\n    setSelectedProf(item);\n  };\n\n  const handleSearchQuery = ({\n    target\n  }) => {\n    setSelectedProf(undefined);\n    setSearchQuery(target.value);\n  };\n\n  const handlePageChange = pageIndex => {\n    setCurrentPage(pageIndex);\n  };\n\n  const handleSort = item => {\n    setSortBy(item);\n  };\n\n  function filterUsers(data) {\n    const filteredUsers = searchQuery ? data.filter(user => user.name.toLowerCase().indexOf(searchQuery.toLowerCase()) !== -1) : selectedProf ? data.filter(user => user.profession === selectedProf._id) : data;\n    return filteredUsers.filter(u => u._id !== currentUserId);\n  }\n\n  const filteredUsers = filterUsers(users);\n  const count = filteredUsers.length;\n\n  const sortedUsers = _.orderBy(filteredUsers, [sortBy.path], [sortBy.order]);\n\n  const usersCrop = paginate(sortedUsers, currentPage, pageSize);\n\n  const clearFilter = () => {\n    setSelectedProf();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d-flex\",\n    children: [professions && !professionsLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex flex-column flex-shrink-0 p-3\",\n      children: [/*#__PURE__*/_jsxDEV(GroupList, {\n        selectedItem: selectedProf,\n        items: professions,\n        onItemSelect: handleProfessionSelect\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-secondary mt-2\",\n        onClick: clearFilter,\n        children: \"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex flex-column\",\n      children: [/*#__PURE__*/_jsxDEV(SearchStatus, {\n        length: count\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"searchQuery\",\n        placeholder: \"Search...\",\n        onChange: handleSearchQuery,\n        value: searchQuery\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this), count > 0 && /*#__PURE__*/_jsxDEV(UserTable, {\n        users: usersCrop,\n        onSort: handleSort,\n        selectedSort: sortBy,\n        onDelete: handleDelete,\n        onToggleBookMark: handleToggleBookMark\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-center\",\n        children: /*#__PURE__*/_jsxDEV(Pagination, {\n          itemsCount: count,\n          pageSize: pageSize,\n          currentPage: currentPage,\n          onPageChange: handlePageChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 9\n  }, this);\n};\n\n_s(UsersListPage, \"Mz4H6Br3h7sZX617ABhzB8acV7o=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = UsersListPage;\nUsersListPage.propTypes = {\n  users: PropTypes.array\n};\nexport default UsersListPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"UsersListPage\");","map":{"version":3,"sources":["/home/designer/GitHub/hangout/client/src/app/components/page/usersListPage/usersListPage.jsx"],"names":["React","useState","useEffect","PropTypes","paginate","Pagination","GroupList","SearchStatus","UserTable","_","getProfessions","getProfessionsLoadingStatus","useSelector","getCurrentUserId","getUsersList","UsersListPage","users","currentUserId","professions","professionsLoading","currentPage","setCurrentPage","searchQuery","setSearchQuery","selectedProf","setSelectedProf","sortBy","setSortBy","path","order","pageSize","handleDelete","userId","console","log","handleToggleBookMark","id","newArray","map","user","_id","bookmark","handleProfessionSelect","item","handleSearchQuery","target","undefined","value","handlePageChange","pageIndex","handleSort","filterUsers","data","filteredUsers","filter","name","toLowerCase","indexOf","profession","u","count","length","sortedUsers","orderBy","usersCrop","clearFilter","propTypes","array"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { paginate } from \"../../../utils/paginate\";\nimport Pagination from \"../../common/pagination\";\nimport GroupList from \"../../common/groupList\";\nimport SearchStatus from \"../../ui/searchStatus\";\nimport UserTable from \"../../ui/usersTable\";\nimport _ from \"lodash\";\nimport {\n    getProfessions,\n    getProfessionsLoadingStatus\n} from \"../../../store/professions\";\nimport { useSelector } from \"react-redux\";\nimport { getCurrentUserId, getUsersList } from \"../../../store/users\";\nconst UsersListPage = () => {\n    const users = useSelector(getUsersList());\n    const currentUserId = useSelector(getCurrentUserId());\n\n    const professions = useSelector(getProfessions());\n    const professionsLoading = useSelector(getProfessionsLoadingStatus());\n    const [currentPage, setCurrentPage] = useState(1);\n    const [searchQuery, setSearchQuery] = useState(\"\");\n    const [selectedProf, setSelectedProf] = useState();\n    const [sortBy, setSortBy] = useState({ path: \"name\", order: \"asc\" });\n    const pageSize = 8;\n\n    const handleDelete = (userId) => {\n        console.log(\"delete user\");\n        // setUsers(users.filter((user) => user._id !== userId));\n    };\n    const handleToggleBookMark = (id) => {\n        const newArray = users.map((user) => {\n            if (user._id === id) {\n                return { ...user, bookmark: !user.bookmark };\n            }\n            return user;\n        });\n        // setUsers(newArray);\n        console.log(newArray);\n    };\n\n    useEffect(() => {\n        setCurrentPage(1);\n    }, [selectedProf, searchQuery]);\n\n    const handleProfessionSelect = (item) => {\n        if (searchQuery !== \"\") setSearchQuery(\"\");\n        setSelectedProf(item);\n    };\n    const handleSearchQuery = ({ target }) => {\n        setSelectedProf(undefined);\n        setSearchQuery(target.value);\n    };\n\n    const handlePageChange = (pageIndex) => {\n        setCurrentPage(pageIndex);\n    };\n    const handleSort = (item) => {\n        setSortBy(item);\n    };\n\n    function filterUsers(data) {\n        const filteredUsers = searchQuery\n            ? data.filter(\n                  (user) =>\n                      user.name\n                          .toLowerCase()\n                          .indexOf(searchQuery.toLowerCase()) !== -1\n              )\n            : selectedProf\n            ? data.filter((user) => user.profession === selectedProf._id)\n            : data;\n        return filteredUsers.filter((u) => u._id !== currentUserId);\n    }\n    const filteredUsers = filterUsers(users);\n    const count = filteredUsers.length;\n    const sortedUsers = _.orderBy(filteredUsers, [sortBy.path], [sortBy.order]);\n    const usersCrop = paginate(sortedUsers, currentPage, pageSize);\n    const clearFilter = () => {\n        setSelectedProf();\n    };\n\n    return (\n        <div className=\"d-flex\">\n            {professions && !professionsLoading && (\n                <div className=\"d-flex flex-column flex-shrink-0 p-3\">\n                    <GroupList\n                        selectedItem={selectedProf}\n                        items={professions}\n                        onItemSelect={handleProfessionSelect}\n                    />\n                    <button\n                        className=\"btn btn-secondary mt-2\"\n                        onClick={clearFilter}\n                    >\n                        Очиститть\n                    </button>\n                </div>\n            )}\n            <div className=\"d-flex flex-column\">\n                <SearchStatus length={count} />\n                <input\n                    type=\"text\"\n                    name=\"searchQuery\"\n                    placeholder=\"Search...\"\n                    onChange={handleSearchQuery}\n                    value={searchQuery}\n                />\n                {count > 0 && (\n                    <UserTable\n                        users={usersCrop}\n                        onSort={handleSort}\n                        selectedSort={sortBy}\n                        onDelete={handleDelete}\n                        onToggleBookMark={handleToggleBookMark}\n                    />\n                )}\n                <div className=\"d-flex justify-content-center\">\n                    <Pagination\n                        itemsCount={count}\n                        pageSize={pageSize}\n                        currentPage={currentPage}\n                        onPageChange={handlePageChange}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\nUsersListPage.propTypes = {\n    users: PropTypes.array\n};\n\nexport default UsersListPage;\n"]},"metadata":{},"sourceType":"module"}